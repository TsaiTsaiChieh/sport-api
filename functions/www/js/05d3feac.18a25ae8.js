(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["05d3feac"],{1776:function(e,t,s){"use strict";var a=s("e6a2"),i=s.n(a);i.a},"17a2":function(e,t,s){"use strict";var a=s("490c"),i=s.n(a);i.a},"1bc5":function(e,t,s){"use strict";var a=s("a63b"),i=s.n(a);i.a},"28a6":function(e,t,s){"use strict";var a=s("aa3b"),i=s.n(a);i.a},3274:function(e,t,s){"use strict";var a=s("4565"),i=s.n(a);i.a},"32bf":function(e,t,s){"use strict";var a=s("af2d"),i=s.n(a);i.a},3546:function(e,t,s){},4565:function(e,t,s){},"490c":function(e,t,s){},"4d2b":function(e,t,s){},"64af":function(e,t,s){"use strict";var a=s("e3ec"),i=s.n(a);i.a},8689:function(e,t,s){"use strict";var a=s("efce"),i=s.n(a);i.a},8935:function(e,t,s){"use strict";var a=s("926f"),i=s.n(a);i.a},"89b8":function(e,t,s){"use strict";var a=s("3546"),i=s.n(a);i.a},"8b24":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",[s("home-chat")],1)},i=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fixed-bottom"},[s("chat-message-box"),s("chat-send-box")],1)},l=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-message page-padding non-selectable relative-position"},[s("q-virtual-scroll",{ref:"virtualListRef",staticClass:"chat-scroll-box",attrs:{items:e.computedMessages},on:{"virtual-scroll":e.handleScroll},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item,i=t.index;return[a.isTime?s("chat-time",{attrs:{timestamp:a.timestamp}}):-1===a.deleteAction?s("div"):0===a.deleteAction?s("div",{staticClass:"text-center q-my-md"},[s("q-badge",{staticClass:"recycling"},[e._v("\n          已收回訊息\n        ")])],1):1===a.deleteAction?s("div"):a.isImg&&a.isSent?s("chat-sent-image",{staticClass:"q-pb-xs",class:{animated:e.computedReply.index===i,shake:e.computedReply.index===i},attrs:{"user-role":e.$store.state.user.profile.role,role:a.role,"killer-level":a.killerLevel,"killer-type":a.killerType,name:a.name,avatar:a.avatar,signature:a.signature,point:a.point,timestamp:a.timestamp,imgUrl:a.file,messageId:a.messageId},on:{reply:e.handleReply,handleOpenImgView:e.handleOpenImgView,deleteMessage:e.deleteMessage}}):a.isImg&&!a.isSent?s("chat-received-image",{staticClass:"q-pb-xs",class:{animated:e.computedReply.index===i,shake:e.computedReply.index===i},attrs:{uid:a.uid,"user-role":e.$store.state.user.profile.role,role:a.role,"killer-level":a.killerLevel,"killer-type":a.killerType,name:a.name,avatar:a.avatar,signature:a.signature,point:a.point,timestamp:a.timestamp,imgUrl:a.file,messageId:a.messageId},on:{reply:e.handleReply,handleOpenImgView:e.handleOpenImgView,deleteMessage:e.deleteMessage}}):a.isVideo&&a.isSent?s("chat-sent-video",{staticClass:"q-pb-xs",class:{animated:e.computedReply.index===i,shake:e.computedReply.index===i},attrs:{"user-role":e.$store.state.user.profile.role,role:a.role,"killer-level":a.killerLevel,"killer-type":a.killerType,name:a.name,avatar:a.avatar,signature:a.signature,point:a.point,timestamp:a.timestamp,videoUrl:a.file,messageId:a.messageId},on:{reply:e.handleReply,deleteMessage:e.deleteMessage}}):a.isVideo&&!a.isSent?s("chat-received-video",{staticClass:"q-pb-xs",class:{animated:e.computedReply.index===i,shake:e.computedReply.index===i},attrs:{uid:a.uid,"user-role":e.$store.state.user.profile.role,role:a.role,"killer-level":a.killerLevel,"killer-type":a.killerType,name:a.name,avatar:a.avatar,signature:a.signature,point:a.point,timestamp:a.timestamp,videoUrl:a.file,messageId:a.messageId},on:{reply:e.handleReply,deleteMessage:e.deleteMessage}}):a.isSent?s("chat-sent-text",{staticClass:"q-pb-xs",class:{animated:e.computedReply.index===i,shake:e.computedReply.index===i},attrs:{"user-role":e.$store.state.user.profile.role,role:a.role,"killer-level":a.killerLevel,"killer-type":a.killerType,name:a.name,avatar:a.avatar,signature:a.signature,point:a.point,text:a.text,timestamp:a.timestamp,messageId:a.messageId,reply:a.reply},on:{"copy-text":e.copyText,reply:e.handleReply,handleOpenImgView:e.handleOpenImgView,deleteMessage:e.deleteMessage}}):s("chat-received-text",{staticClass:"q-pb-xs",class:{animated:e.computedReply.index===i,shake:e.computedReply.index===i},attrs:{uid:a.uid,"user-role":e.$store.state.user.profile.role,role:a.role,"killer-level":a.killerLevel,"killer-type":a.killerType,name:a.name,avatar:a.avatar,signature:a.signature,point:a.point,text:a.text,timestamp:a.timestamp,messageId:a.messageId,reply:a.reply},on:{"copy-text":e.copyText,reply:e.handleReply,handleOpenImgView:e.handleOpenImgView,deleteMessage:e.deleteMessage}})]}}])}),s("div",{staticClass:"info-box"},[s("div",{staticClass:"text-right"},[e.isAutoScroll||e.tipText?e._e():s("q-btn",{staticClass:"chat-scroll-last-btn no-shadow",attrs:{icon:"arrow_downward"},on:{click:e.scrollToLast}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tipText,expression:"tipText"}],staticClass:"tip-text-box q-px-sm q-py-xs row no-wrap page-padding",on:{click:e.scrollToLast}},[s("span",{staticClass:"text-weight-bold text-no-wrap q-mr-sm"},[e._v("\n        "+e._s(e.tipName)+"\n      ")]),s("span",{staticClass:"ellipsis"},[e._v("\n        "+e._s(e.tipText)+"\n      ")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.computedReply.name,expression:"computedReply.name"}],staticClass:"reply-box page-padding q-py-sm",on:{click:e.focusReplyMessage}},[e.computedReply.text?s("div",{staticClass:"row items-center"},[s("div",{staticClass:"q-mr-sm"},[s("img",{staticClass:"avatar",attrs:{src:e.computedReply.avatar,alt:""}})]),s("div",{staticClass:"q-mr-xs col"},[s("div",{staticClass:"name text-bold"},[e._v(e._s(e.computedReply.name))]),s("div",{staticClass:"text ellipsis"},[e._v(e._s(e.computedReply.text))])]),s("div",{staticClass:"self-start"},[s("q-icon",{staticClass:"cursor-pointer",attrs:{size:"20px",name:"close"},on:{click:function(t){return t.stopPropagation(),e.closeReplyBox(t)}}})],1)]):e._e(),e.computedReply.imgUrl?s("div",{staticClass:"row items-center"},[s("div",{staticClass:"q-mr-sm"},[s("img",{staticClass:"avatar",attrs:{src:e.computedReply.avatar,alt:""}})]),s("div",{staticClass:"q-mr-xs col"},[s("div",{staticClass:"name text-bold"},[e._v(e._s(e.computedReply.name))])]),s("div",{staticClass:"img-box q-mr-md"},[s("img",{staticClass:"q-mr-xs",staticStyle:{},attrs:{src:e.computedReply.imgUrl,alt:""}})]),s("div",{staticClass:"self-start"},[s("q-icon",{staticClass:"cursor-pointer",attrs:{size:"20px",name:"close"},on:{click:function(t){return t.stopPropagation(),e.closeReplyBox(t)}}})],1)]):e._e(),e.computedReply.videoUrl?s("div",{staticClass:"row items-center"},[s("div",{staticClass:"q-mr-sm"},[s("img",{staticClass:"avatar",attrs:{src:e.computedReply.avatar,alt:""}})]),s("div",{staticClass:"q-mr-xs col"},[s("div",{staticClass:"name text-bold"},[e._v(e._s(e.computedReply.name))])]),s("div",{staticClass:"video-box q-mr-md"},[s("video",{staticClass:"video",attrs:{src:e.computedReply.videoUrl}}),s("q-icon",{staticClass:"play-icon",attrs:{name:"play_circle_outline"}})],1),s("div",{staticClass:"self-start"},[s("q-icon",{staticClass:"cursor-pointer",attrs:{size:"20px",name:"close"},on:{click:function(t){return t.stopPropagation(),e.closeReplyBox(t)}}})],1)]):e._e()])]),s("textarea",{ref:"copyTextarea",staticClass:"copy-textarea"}),s("q-dialog",{attrs:{"full-height":"","full-width":""},on:{"before-hide":function(t){e.imgView.imgSize=100}},model:{value:e.imgView.isShow,callback:function(t){e.$set(e.imgView,"isShow",t)},expression:"imgView.isShow"}},[s("div",{staticClass:"no-shadow"},[s("img",{staticClass:"block",staticStyle:{margin:"0 auto"},attrs:{width:e.imgView.imgSize+"%",src:e.imgView.imgURL,alt:""}}),s("div",{staticClass:"q-px-md q-py-sm bg-blue-grey-9 fixed-bottom row"},[s("div",[s("q-btn",{staticClass:"q-mr-sm",attrs:{size:"sm",flat:"",round:"",color:"white",icon:"remove"},on:{click:function(t){e.imgView.imgSize=10===e.imgView.imgSize?10:e.imgView.imgSize-10}}}),s("q-btn",{attrs:{size:"sm",flat:"",round:"",color:"white",icon:"add"},on:{click:function(t){e.imgView.imgSize=200===e.imgView.imgSize?200:e.imgView.imgSize+10}}})],1),s("q-space"),s("div",[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{size:"sm",flat:"",round:"",color:"white",icon:"close"}})],1)],1)])])],1)},r=[],c=(s("7f7f"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-time row items-center"},[s("div",{staticClass:"line col"}),s("span",{staticClass:"text q-px-lg q-py-xs q-mx-md"},[e._v("\n    "+e._s(e.computedTime)+"\n  ")]),s("div",{staticClass:"line col"})])}),p=[],m=(s("c5f6"),s("bd4c")),d={props:{timestamp:{type:Number}},data:function(){return{weeks:["日","一","二","三","四","五","六"]}},computed:{computedTime:function(){var e=m["b"].getDateDiff(new Date(this.timestamp),new Date,"days"),t=m["b"].formatDate(this.timestamp,"d");return 0===e?"今天":-1===e?"昨天":-2===e?"前天":m["b"].formatDate(this.timestamp,"MM月DD號 星期".concat(this.weeks[t]))}}},u=d,v=(s("c0a83"),s("2877")),g=Object(v["a"])(u,c,p,!1,null,"2648fd96",null),f=g.exports,h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row no-wrap",style:{fontSize:e.size}},[s("div",{staticClass:"q-mr-sm"},[s("img",{staticClass:"avatar",attrs:{src:e.avatar,alt:""},on:{click:function(t){e.isOpenProfileDialog=!0}}}),"admin"===e.$store.state.user.role?s("app-dialog-edit-profile",{attrs:{name:e.name,avatar:e.avatar,signature:e.signature,point:e.point,levels:[{level:1,type:"金牌 : NBA"},{level:2,type:"銀牌:MLB"},{level:3,type:"銅牌:中華職棒"}]},model:{value:e.isOpenProfileDialog,callback:function(t){e.isOpenProfileDialog=t},expression:"isOpenProfileDialog"}}):e._e(),"admin"!==e.$store.state.user.role?s("app-dialog-profile",{attrs:{name:e.name,avatar:e.avatar,signature:e.signature,point:e.point,levels:[{level:1,type:"金牌:NBA"},{level:2,type:"銀牌:MLB"},{level:3,type:"銅牌:中華職棒"}]},model:{value:e.isOpenProfileDialog,callback:function(t){e.isOpenProfileDialog=t},expression:"isOpenProfileDialog"}}):e._e()],1),s("div",[s("div",{staticClass:"row items-center q-my-xs"},["killer"===e.role?s("span",{staticClass:"row items-center"},[e.killerLevel?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/killer-"+e.killerLevel+".png",alt:""}}):e._e(),e.killerType?s("span",{staticClass:"q-mr-xs"},[e._v("\n          "+e._s(e.killerType)+"\n        ")]):e._e()]):e._e(),"admin"===e.role?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/admin.png",alt:""}}):e._e(),s("span",{staticClass:"text-grey-6"},[e._v(e._s(e.name))])]),s("div",{staticClass:"row no-wrap items-center"},[s("div",{staticClass:"message q-mr-sm",class:{"is-reply":!!e.reply,"user-role":"user"===e.role,"admin-role":"admin"===e.role,"killer-role":"killer"===e.role}},[e.reply&&e.reply.messageId?s("div",{staticClass:"reply-box row q-pa-md"},[s("img",{staticClass:"avatar q-mr-sm",attrs:{src:e.reply.avatar,alt:""}}),s("div",{staticClass:"col q-mr-sm"},[s("div",{staticClass:"text-bold"},[e._v(e._s(e.reply.name))]),e.reply.text?s("div",{staticClass:"ellipsis-2-lines full-width"},[e._v(e._s(e.reply.text))]):e._e()]),s("div",{staticClass:"img-box"},[e.reply.imgUrl?s("img",{staticClass:"q-mr-xs",attrs:{src:e.reply.imgUrl,alt:""},on:{click:function(t){return e.$emit("handleOpenImgView",{imgURL:e.reply.imgUrl})}}}):e._e()]),e.reply.videoUrl?s("div",{staticClass:"video-box q-mr-xs"},[s("video",{staticClass:"video",attrs:{src:e.reply.videoUrl}}),s("q-icon",{staticClass:"play-icon",attrs:{name:"play_circle_outline"}})],1):e._e()]):e._e(),s("div",{staticClass:"text q-py-sm q-px-md text-pre"},[e._v(e._s(e.text))]),"user"===e.userRole||"killer"===e.userRole?s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",{on:{click:function(t){return e.handleReport({reportTarget:"content",avatar:e.avatar,name:e.name})}}},[e._v("\n                檢舉內文\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.isOpenReportDialog=!0}}},[s("q-item-section",{on:{click:function(t){return e.handleReport({reportTarget:"user",avatar:e.avatar,name:e.name})}}},[e._v("\n                檢舉玩家\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",{on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,text:e.text,messageId:e.messageId})}}},[e._v("\n                回覆\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",{on:{click:function(t){return e.$emit("copy-text",{text:e.text})}}},[e._v("\n                複製\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:1})}}},[s("q-item-section",[e._v("\n                刪除\n              ")])],1)],1)],1):e._e(),"admin"===e.userRole?s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:-1})}}},[s("q-item-section",[e._v("\n                移除留言\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",[e._v("\n                凍結玩家\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,text:e.text,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",{on:{click:function(t){return e.$emit("copy-text",{text:e.text})}}},[e._v("\n                複製\n              ")])],1)],1)],1):e._e()],1),s("div",{staticClass:"text-no-wrap text-grey-6"},[e._v("\n        "+e._s(e.computedTime)+"\n      ")])])]),s("app-dialog-report",{attrs:{uid:e.uid,"report-target":e.reportTarget,name:e.name,avatar:e.avatar},model:{value:e.isOpenReportDialog,callback:function(t){e.isOpenReportDialog=t},expression:"isOpenReportDialog"}}),s("app-dialog-point",{model:{value:e.isOpenPointDialog,callback:function(t){e.isOpenPointDialog=t},expression:"isOpenPointDialog"}})],1)},y=[],x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{ref:"dialog",on:{hide:function(t){return e.$emit("hide",!1)}}},[s("q-card",{staticClass:"card q-px-md"},[s("q-card-section",[s("div",{staticClass:"row justify-center items-center"},[s("div",{staticClass:"text-h5"},[e._v("\n          原因填寫\n        ")])])]),s("q-card-section",{staticClass:"q-px-md"},[s("q-form",{on:{submit:e.onSubmit}},[s("div",{staticClass:"row items-center q-mb-md"},[s("div",{staticClass:"report-label text-no-wrap q-px-sm q-py-xs radius-3 q-mr-md"},[e._v("\n            申訴對象\n          ")]),s("div",{staticClass:"row items-center no-wrap q-my-sm"},[s("img",{staticClass:"avatar q-mr-sm",attrs:{src:e.avatar,alt:""}}),s("span",{staticStyle:{"font-size":"16px","word-break":"break-all"}},[e._v(e._s(e.name))])])]),s("div",{staticClass:"row items-center q-mb-md"},[s("span",{staticClass:"report-label q-px-sm q-py-xs radius-3 q-mr-md"},[e._v("\n            申訴原因\n          ")]),s("div",[s("q-btn-dropdown",{staticClass:"select q-pl-md q-py-none q-my-sm",attrs:{dense:"",rounded:"",unelevated:"",label:e.selectReason||"原因選擇","dropdown-icon":"r_arrow_drop_down","content-style":"border-radius: 10px;margin-top: 3px;"}},[s("q-list",{staticClass:"menu"},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",active:"打廣告"===e.selectReason},on:{click:function(t){return e.onItemClick("打廣告")}}},[s("q-item-section",[e._v("打廣告")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",active:"內容不實"===e.selectReason},on:{click:function(t){return e.onItemClick("內容不實")}}},[s("q-item-section",[e._v("內容不實")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",active:"灌水洗版"===e.selectReason},on:{click:function(t){return e.onItemClick("灌水洗版")}}},[s("q-item-section",[e._v("灌水洗版")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",active:"人身攻擊"===e.selectReason},on:{click:function(t){return e.onItemClick("人身攻擊")}}},[s("q-item-section",[e._v("人身攻擊")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",active:"其他"===e.selectReason},on:{click:function(t){return e.onItemClick("其他")}}},[s("q-item-section",[e._v("其他")])],1)],1)],1)],1)]),s("div",{staticClass:"row no-wrap items-center q-mb-md"},[s("span",{staticClass:"report-label q-px-sm q-py-xs radius-3 q-mr-md text-no-wrap"},[e._v("\n            照片選擇\n          ")]),s("div",{staticClass:"col ellipsis"},[s("span",{staticClass:"file-name q-pl-sm"},[e._v(e._s(e.fileName||"請上傳照片"))])]),s("chat-upload-file",{staticClass:"upload q-ml-sm q-px-sm q-py-xs",attrs:{accept:"image/*",handleAddUploadFile:e.handleAddUploadFile}})],1),"其他"===this.selectReason?s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reason,expression:"reason"}],staticClass:"reason radius-3 q-px-md q-py-sm q-mb-md",attrs:{rows:"10",placeholder:"請填寫申訴原因"},domProps:{value:e.reason},on:{input:function(t){t.target.composing||(e.reason=t.target.value)}}}):e._e(),s("div",{staticClass:"text-center"},[s("q-btn",{attrs:{label:"確認送出",type:"submit",color:"primary"}})],1)])],1)],1)],1)},b=[],q=(s("28a5"),s("1732")),C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",{staticClass:"btn btn-info cursor-pointer"},[s("input",{ref:"chatUploadImg",staticStyle:{display:"none"},attrs:{type:"file",capture:e.capture,accept:e.accept,multiple:""},on:{change:e.handleChange}}),s("q-icon",{staticClass:"text-white",attrs:{name:"photo",size:"sm"}})],1)},k=[],w={props:{capture:String,handleAddUploadFile:Function,accept:{type:String,default:"image/*,video/*"}},data:function(){return{maxFileNumber:9,uploadFileInput:null}},methods:{handleChange:function(){var e=this.$refs.chatUploadImg.files;if(e.length>this.maxFileNumber)this.$q.dialog({title:"上傳圖片提示",message:"You can upload maximum ".concat(this.maxFileNumber," files.")}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}));else{for(var t=0,s=e.length;t<s;t+=1)this.handleAddUploadFile({file:e[t]});this.$refs.chatUploadImg.value=null}}}},_=w,S=s("fe09"),N=Object(v["a"])(_,C,k,!1,null,"5a05badd",null),T=N.exports;N.options.components=Object.assign({QIcon:S["l"]},N.options.components||{});var I={components:{ChatUploadFile:T},model:{prop:"isOpen",event:"hide"},props:{isOpen:Boolean,"report-target":{type:String},uid:{type:String},avatar:{type:String},name:{type:String}},data:function(){return{fileName:"",fileUrl:"",selectReason:"",reason:"",model:null}},watch:{isOpen:function(e){e&&this.$refs.dialog.show()}},methods:{onItemClick:function(e){this.selectReason=e},onSubmit:function(){0!==this.selectReason.trim().length?this.$refs.dialog.hide():this.$q.dialog({title:"送出提示",message:"請填入內容!"}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))},handleAddUploadFile:function(e){var t=this,s=e.file;if(/^image/.test(s.type)){if(s.size>=4e6)return void this.$q.dialog({title:"上傳檔案",message:"上傳圖片 ".concat(s.name," 失敗，大小必須在 4 mb 以下")}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}));var a=this.$firebase.storage().ref(),i=(new Date).getTime()+Object(q["a"])(),n=s.type.split("/")[s.type.split("/").length-1],l=a.child("accuse/".concat(this.uid,"/").concat(i,".").concat(n));l.put(s).then((function(e){l.getDownloadURL().then((function(e){t.fileUrl=e}))}));var o=new FileReader;o.onload=function(e){t.fileName=s.name},o.readAsDataURL(s)}}}},$=I,R=(s("17a2"),Object(v["a"])($,x,b,!1,null,"1ab2c98a",null)),O=R.exports;R.options.components=Object.assign({QDialog:S["h"],QCard:S["e"],QCardSection:S["f"],QForm:S["j"],QBtnDropdown:S["d"],QList:S["r"],QItem:S["n"],QItemSection:S["p"],QBtn:S["c"]},R.options.components||{}),R.options.directives=Object.assign({ClosePopup:S["a"]},R.options.directives||{});var D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{ref:"dialog",on:{hide:function(t){return e.$emit("hide",!1)}}},[s("q-card",{staticClass:"card m-card container"},[s("q-card-section",{staticClass:"q-px-lg q-my-lg"},[s("div",[s("div",{staticClass:"row items-center q-mb-lg"},[s("img",{staticClass:"avatar q-mr-sm",attrs:{src:e.avatar,alt:""}}),s("div",[s("div",{staticClass:"q-mt-sm",staticStyle:{"font-size":"16px"}},[e._v(e._s(e.name))]),s("div",{staticClass:"text-grey-6",staticStyle:{"font-size":"12px"}},[e._v(e._s(e.signature))]),s("div",{staticClass:"row items-center"},[s("img",{staticClass:"point-icon",attrs:{alt:"point img",src:"/statics/point.png"}}),s("span",{staticClass:"text-grey-6 q-mx-xs",staticStyle:{"font-size":"18px"}},[e._v(e._s(e.dataPoint))]),s("span",{staticStyle:{"font-size":"12px"}},[e._v("點")])])])]),0===e.dataLevels.length?s("div",{staticClass:"text-center text-bold",staticStyle:{"font-size":"18px"}},[e._v("無稱號")]):e._e(),s("div",[e._l(e.dataLevels,(function(t,a){return s("span",{key:"level-"+a,staticClass:"q-pr-sm"},[s("span",{staticClass:"self-level relative-position"},[s("img",{staticClass:"level-icon",attrs:{src:"/statics/chat/dialog/killer-"+t.level+".png",alt:""}}),s("span",{staticClass:"row items-center level-type q-pr-sm"},[s("span",{staticClass:"q-pl-lg q-pr-xs q-py-xs"},[e._v(e._s(t.type)+" ")]),s("q-icon",{staticClass:"text-grey-7 cursor-pointer q-py-xs",attrs:{size:"20px",name:"close"},on:{click:function(t){return e.openDeleteLevel({index:a})}}})],1)])])})),s("div",{staticClass:"line q-my-md"})],2),s("div",[s("div",{staticClass:"text-bold text-center q-pb-md",staticStyle:{"font-size":"18px"}},[e._v("稱號選擇")]),s("div",{staticClass:"row items-center justify-between no-wrap m-select"},[s("span",[s("q-btn-dropdown",{staticClass:"select m-btn q-pl-xs q-mr-xs q-my-xs",attrs:{dense:"",rounded:"",unelevated:"","menu-anchor":"top left","menu-self":"bottom left",label:e.selectType||"球隊聯盟","dropdown-icon":"r_arrow_drop_down","content-style":"box-shadow: none;border-radius: 10px"}},[s("div",{staticClass:"menu q-px-md q-pb-sm"},[s("div",{staticClass:"text-white q-py-sm",attrs:{size:"16px"}},[e._v("棒球")]),s("div",[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"MLB"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"MLB"},on:{click:function(t){return e.onTypeClick("MLB")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"中華職棒"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"中華職棒"},on:{click:function(t){return e.onTypeClick("中華職棒")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"韓國職棒"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"韓國職棒"},on:{click:function(t){return e.onTypeClick("韓國職棒")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"日本職棒"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"日本職棒"},on:{click:function(t){return e.onTypeClick("日本職棒")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"澳洲職棒"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"澳洲職棒"},on:{click:function(t){return e.onTypeClick("澳洲職棒")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"墨西哥職棒"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"墨西哥職棒"},on:{click:function(t){return e.onTypeClick("墨西哥職棒")}}})],1),s("div",{staticClass:"text-white q-py-sm",attrs:{size:"16px"}},[e._v("籃球")]),s("div",[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"NBA"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"NBA"},on:{click:function(t){return e.onTypeClick("NBA")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"SBL"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"SBL"},on:{click:function(t){return e.onTypeClick("SBL")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"WNBA"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"WNBA"},on:{click:function(t){return e.onTypeClick("WNBA")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"中國職籃"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"中國職籃"},on:{click:function(t){return e.onTypeClick("中國職籃")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"韓國職籃"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"韓國職籃"},on:{click:function(t){return e.onTypeClick("韓國職籃")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"日本職籃"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"日本職籃"},on:{click:function(t){return e.onTypeClick("日本職籃")}}})],1),s("div",{staticClass:"text-white q-py-sm",attrs:{size:"16px"}},[e._v("冰球")]),s("div",[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"NHL冰球"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"NHL冰球"},on:{click:function(t){return e.onTypeClick("NHL冰球")}}})],1),s("div",{staticClass:"text-white q-py-sm",attrs:{size:"16px"}},[e._v("其他")]),s("div",[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-type q-py-none",class:{active:"足球"===e.selectType},attrs:{dense:"",rounded:"",unelevated:"",label:"足球"},on:{click:function(t){return e.onTypeClick("足球")}}})],1)])])],1),s("span",[s("q-btn-dropdown",{staticClass:"select q-pl-xs q-mr-xs q-my-xs",attrs:{dense:"",rounded:"",unelevated:"","menu-anchor":"top left","menu-self":"bottom left",label:e.levelName||"大神階級","dropdown-icon":"r_arrow_drop_down","content-style":"box-shadow: none;border-radius: 10px;"}},[s("q-list",{staticClass:"menu"},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-level",attrs:{clickable:"",focused:"鑽石大神"===e.levelName},on:{click:function(t){return e.onLevelClick("鑽石大神",100)}}},[s("q-item-section",[e._v("鑽石大神")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-level",attrs:{clickable:"",focused:"白金大神"===e.levelName},on:{click:function(t){return e.onLevelClick("白金大神",50)}}},[s("q-item-section",[e._v("白金大神")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-level",attrs:{clickable:"",focused:"金牌大神"===e.levelName},on:{click:function(t){return e.onLevelClick("金牌大神",1)}}},[s("q-item-section",[e._v("金牌大神")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-level",attrs:{clickable:"",focused:"銀牌大神"===e.levelName},on:{click:function(t){return e.onLevelClick("銀牌大神",2)}}},[s("q-item-section",[e._v("銀牌大神")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"select-level",attrs:{clickable:"",focused:"銅牌大神"===e.levelName},on:{click:function(t){return e.onLevelClick("銅牌大神",3)}}},[s("q-item-section",[e._v("銅牌大神")])],1)],1)],1)],1),s("span",{staticClass:"relative-position",on:{click:e.handleSubmit}},[s("q-btn",{staticClass:"btn",attrs:{dense:"",unelevated:""}}),s("q-icon",{staticClass:"send-icon cursor-pointer rotate-315",attrs:{name:"r_send"}})],1)]),s("div",{staticClass:"line q-my-lg"})]),s("div",{staticClass:"row items-center justify-between no-wrap m-point"},[s("img",{staticClass:"point-icon q-mr-sm",attrs:{alt:"point img",src:"/statics/point.png"}}),s("span",{staticClass:"text-bold q-mr-sm",staticStyle:{"font-size":"16px"}},[e._v("點數")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.addPoint,expression:"addPoint"}],staticClass:"input text-bold q-mr-sm q-px-sm",attrs:{type:"number"},domProps:{value:e.addPoint},on:{input:function(t){t.target.composing||(e.addPoint=t.target.value)}}}),s("q-btn",{staticClass:"gift q-px-md q-my-md",attrs:{dense:"",unelevated:"",label:"贈送"},on:{click:e.handlePoint}})],1)])])],1)],1)},L=[],A=s("4db1"),U=s.n(A),M={model:{prop:"isOpen",event:"hide"},props:{isOpen:Boolean,avatar:{type:String},name:{type:String},signature:{type:String},point:{type:Number},levels:{type:Array}},data:function(){return{selectType:"",selectLevel:null,levelName:"",dataPoint:this.point,addPoint:0,dataLevels:U()(this.levels),isVisibleType:!1,isVisibleLevel:!1}},watch:{isOpen:function(e){e&&this.$refs.dialog.show()}},methods:{openDeleteLevel:function(e){var t=this,s=e.index;this.$q.dialog({title:"Alert",message:"確定要刪除嗎？",cancel:!0}).onOk((function(){t.dataLevels.splice(s,1)})).onCancel((function(){})).onDismiss((function(){}))},onTypeClick:function(e){this.selectType=e},onLevelClick:function(e,t){this.levelName=e,this.selectLevel=t},handleSubmit:function(){""===this.selectType||null===this.selectLevel?this.$q.dialog({title:"Alert",message:"請選擇聯盟與階級！"}).onOk((function(){})):(this.dataLevels.push({level:this.selectLevel,type:this.selectType}),this.selectType="",this.levelName="",this.selectLevel=null)},handlePoint:function(){this.dataPoint+=parseInt(this.addPoint),this.addPoint=0}}},P=M,j=(s("89b8"),Object(v["a"])(P,D,L,!1,null,"29dac782",null)),Q=j.exports;j.options.components=Object.assign({QDialog:S["h"],QCard:S["e"],QCardSection:S["f"],QIcon:S["l"],QBtnDropdown:S["d"],QBtn:S["c"],QList:S["r"],QItem:S["n"],QItemSection:S["p"]},j.options.components||{}),j.options.directives=Object.assign({ClosePopup:S["a"]},j.options.directives||{});var z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{ref:"dialog",on:{hide:function(t){return e.$emit("hide",!1)}}},[s("q-card",{staticClass:"card container"},[s("q-card-section",{staticClass:"q-px-xl q-py-lg"},[s("div",[s("div",{staticClass:"text-center q-my-xs"},[s("img",{staticClass:"avatar q-my-md",attrs:{src:e.avatar,alt:""}}),s("div",{staticStyle:{"font-size":"16px"}},[e._v(e._s(e.name))]),s("div",[s("span",{staticClass:"text-grey-6",staticStyle:{"font-size":"12px"}},[e._v("\n              "+e._s(e.signature)+"\n            ")])])]),s("div",{staticClass:"row justify-center"},[s("div",{staticClass:"box"},[s("div",{staticClass:"row items-center justify-center q-my-md"},[s("img",{staticClass:"point-icon",attrs:{alt:"point img",src:"/statics/point.png"}}),s("span",{staticClass:"text-bold text-red-10 q-mx-md",staticStyle:{"font-size":"18px"}},[e._v(e._s(e.point))]),s("span",[e._v("點")])]),0===e.levels.length?s("div",{staticClass:"text-center text-bold",staticStyle:{"font-size":"18px"}},[e._v("無稱號")]):e._e(),e._l(e.levels,(function(t,a){return s("div",{key:"level-"+a,staticClass:"q-mb-sm"},[s("span",{staticClass:"level relative-position"},[s("img",{staticClass:"level-icon",attrs:{src:"/statics/chat/dialog/killer-"+t.level+".png",alt:""}}),s("span",{staticClass:"level-type q-pl-lg q-pr-md q-py-xs"},[e._v(e._s(t.type))])])])}))],2)])])])],1)],1)},B=[],V={model:{prop:"isOpen",event:"hide"},props:{isOpen:Boolean,avatar:{type:String},name:{type:String},signature:{type:String},point:{type:Number},levels:{type:Array}},watch:{isOpen:function(e){e&&this.$refs.dialog.show()}}},F=V,E=(s("8935"),Object(v["a"])(F,z,B,!1,null,"49bb059f",null)),H=E.exports;E.options.components=Object.assign({QDialog:S["h"],QCard:S["e"],QCardSection:S["f"]},E.options.components||{});var W=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{ref:"dialog",on:{hide:function(t){return e.$emit("hide",!1)}}},[s("q-card",{staticClass:"card container relative-position"},[s("q-card-section",{staticClass:"q-px-xl q-py-lg"},[s("div",{staticClass:"bg"},[s("img",{staticClass:"ribbon-1",attrs:{src:"/statics/ribbon-1.png",alt:""}}),s("img",{staticClass:"ribbon-2",attrs:{src:"/statics/ribbon-2.png",alt:""}})]),s("div",{staticClass:"title text-bold text-white"},[e._v("\n        邀請代碼活動\n      ")]),s("div",{staticClass:"point-text row items-end text-bold"},[s("span",[e._v("獲得")]),s("span",{staticClass:"point q-mx-md"},[e._v(e._s(e.point))]),s("span",[e._v("點數")])])])],1)],1)},J=[],Y={model:{prop:"isOpen",event:"hide"},props:{isOpen:Boolean,point:{type:Number,default:200}},watch:{isOpen:function(e){e&&this.$refs.dialog.show()}}},G=Y,K=(s("c950"),Object(v["a"])(G,W,J,!1,null,"1615ba90",null)),X=K.exports;K.options.components=Object.assign({QDialog:S["h"],QCard:S["e"],QCardSection:S["f"]},K.options.components||{});var Z={props:{uid:{type:String},size:{type:String,default:"14px"},avatar:String,signature:String,point:Number,text:String,role:{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},"killer-level":{type:Number},"killer-type":{type:String},"user-role":{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},name:{type:String},timestamp:{type:Number},messageId:{type:String},reply:{type:Object}},components:{AppDialogReport:O,AppDialogEditProfile:Q,AppDialogProfile:H,AppDialogPoint:X},data:function(){return{isOpenReportDialog:!1,isOpenProfileDialog:!1,isOpenPointDialog:!1,reportTarget:""}},computed:{computedTime:function(){var e=m["b"].formatDate(this.timestamp,"A hh:mm");return e}},methods:{handleReport:function(e){var t=e.reportTarget;e.avatar,e.name;this.reportTarget=t}}},ee=Z,te=(s("1776"),Object(v["a"])(ee,h,y,!1,null,"a5be4bcc",null)),se=te.exports;te.options.components=Object.assign({QIcon:S["l"],QMenu:S["s"],QList:S["r"],QItem:S["n"],QItemSection:S["p"]},te.options.components||{}),te.options.directives=Object.assign({ClosePopup:S["a"]},te.options.directives||{});var ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row no-wrap",style:{fontSize:e.size}},[s("div",{staticClass:"q-mr-sm"},[s("img",{staticClass:"avatar",attrs:{src:e.avatar,alt:""},on:{click:function(t){e.isOpenProfileDialog=!0}}}),"admin"===e.$store.state.user.role?s("app-dialog-edit-profile",{attrs:{name:e.name,avatar:e.avatar,signature:e.signature,point:e.point,levels:[{level:1,type:"金牌:NBA"},{level:2,type:"銀牌:MLB"},{level:3,type:"銅牌:中華職棒"}]},model:{value:e.isOpenProfileDialog,callback:function(t){e.isOpenProfileDialog=t},expression:"isOpenProfileDialog"}}):e._e(),"admin"!==e.$store.state.user.role?s("app-dialog-profile",{attrs:{name:e.name,avatar:e.avatar,signature:e.signature,point:e.point,levels:[{level:3,type:"金牌:NBA"},{level:2,type:"銀牌:MLB"},{level:3,type:"銅牌:中華職棒"}]},model:{value:e.isOpenProfileDialog,callback:function(t){e.isOpenProfileDialog=t},expression:"isOpenProfileDialog"}}):e._e()],1),s("div",[s("div",{staticClass:"row items-center q-my-xs"},["killer"===e.role?s("span",{staticClass:"row items-center"},[e.killerLevel?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/killer-"+e.killerLevel+".png",alt:""}}):e._e(),e.killerType?s("span",{staticClass:"q-mr-xs"},[e._v("\n          "+e._s(e.killerType)+"\n        ")]):e._e()]):e._e(),"admin"===e.role?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/admin.png",alt:""}}):e._e(),s("span",{staticClass:"text-grey-6"},[e._v(e._s(e.name))])]),s("div",{staticClass:"row no-wrap items-center"},[s("div",{staticClass:"text q-mr-sm q-px-md q-py-sm",class:{"user-role":"user"===e.role,"admin-role":"admin"===e.role,"killer-role":"killer"===e.role}},[s("img",{staticClass:"img",attrs:{src:e.imgUrl,alt:""},on:{click:function(t){return e.$emit("handleOpenImgView",{imgURL:e.imgUrl})}}}),"user"===e.userRole||"killer"===e.userRole?s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",{on:{click:function(t){return e.handleReport({reportTarget:"content",avatar:e.avatar,name:e.name})}}},[e._v("\n                檢舉內文\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.isOpenReportDialog=!0}}},[s("q-item-section",{on:{click:function(t){return e.handleReport({reportTarget:"user",avatar:e.avatar,name:e.name})}}},[e._v("\n                檢舉玩家\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,imgUrl:e.imgUrl,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:1})}}},[s("q-item-section",[e._v("\n                刪除\n              ")])],1)],1)],1):e._e(),"admin"===e.userRole?s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:-1})}}},[s("q-item-section",[e._v("\n                移除留言\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",[e._v("\n                凍結玩家\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,imgUrl:e.imgUrl,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1)],1)],1):e._e()],1),s("div",{staticClass:"text-no-wrap text-grey-6"},[e._v("\n        "+e._s(e.computedTime)+"\n      ")])])]),s("app-dialog-report",{attrs:{uid:e.uid,"report-target":e.reportTarget,name:e.name,avatar:e.avatar},model:{value:e.isOpenReportDialog,callback:function(t){e.isOpenReportDialog=t},expression:"isOpenReportDialog"}})],1)},ie=[],ne={props:{uid:{type:String},size:{type:String,default:"14px"},avatar:String,signature:String,point:Number,imgUrl:String,role:{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},"killer-level":{type:Number},"killer-type":{type:String},"user-role":{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},name:{type:String},timestamp:{type:Number},messageId:{type:String}},components:{AppDialogReport:O,AppDialogEditProfile:Q,AppDialogProfile:H},data:function(){return{isOpenReportDialog:!1,isOpenProfileDialog:!1,reportTarget:""}},computed:{computedTime:function(){var e=m["b"].formatDate(this.timestamp,"A hh:mm");return e}},methods:{handleReport:function(e){var t=e.reportTarget;e.avatar,e.name;this.reportTarget=t}}},le=ne,oe=(s("1bc5"),Object(v["a"])(le,ae,ie,!1,null,"9f6ef352",null)),re=oe.exports;oe.options.components=Object.assign({QMenu:S["s"],QList:S["r"],QItem:S["n"],QItemSection:S["p"]},oe.options.components||{}),oe.options.directives=Object.assign({ClosePopup:S["a"]},oe.options.directives||{});var ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row no-wrap",style:{fontSize:e.size}},[s("div",{staticClass:"q-mr-sm"},[s("img",{staticClass:"avatar",attrs:{src:e.avatar,alt:""},on:{click:function(t){e.isOpenProfileDialog=!0}}}),"admin"===e.$store.state.user.role?s("app-dialog-edit-profile",{attrs:{name:e.name,avatar:e.avatar,signature:e.signature,point:e.point,levels:[{level:1,type:"金牌:NBA"},{level:2,type:"銀牌:MLB"},{level:3,type:"銅牌:中華職棒"}]},model:{value:e.isOpenProfileDialog,callback:function(t){e.isOpenProfileDialog=t},expression:"isOpenProfileDialog"}}):e._e(),"admin"!==e.$store.state.user.role?s("app-dialog-profile",{attrs:{name:e.name,avatar:e.avatar,signature:e.signature,point:e.point,levels:[{level:3,type:"金牌:NBA"},{level:2,type:"銀牌:MLB"},{level:3,type:"銅牌:中華職棒"}]},model:{value:e.isOpenProfileDialog,callback:function(t){e.isOpenProfileDialog=t},expression:"isOpenProfileDialog"}}):e._e()],1),s("div",[s("div",{staticClass:"row items-center q-my-xs"},["killer"===e.role?s("span",{staticClass:"row items-center"},[e.killerLevel?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/killer-"+e.killerLevel+".png",alt:""}}):e._e(),e.killerType?s("span",{staticClass:"q-mr-xs"},[e._v("\n          "+e._s(e.killerType)+"\n        ")]):e._e()]):e._e(),"admin"===e.role?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/admin.png",alt:""}}):e._e(),s("span",{staticClass:"text-grey-6"},[e._v(e._s(e.name))])]),s("div",{staticClass:"row no-wrap items-center"},[s("div",{staticClass:"text q-mr-sm q-px-md q-py-sm",class:{"user-role":"user"===e.role,"admin-role":"admin"===e.role,"killer-role":"killer"===e.role}},[s("video",{staticClass:"video",attrs:{src:e.videoUrl,controls:""}}),"user"===e.userRole||"killer"===e.userRole?s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",{on:{click:function(t){return e.handleReport({reportTarget:"content",avatar:e.avatar,name:e.name})}}},[e._v("\n                檢舉內文\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.isOpenReportDialog=!0}}},[s("q-item-section",{on:{click:function(t){return e.handleReport({reportTarget:"user",avatar:e.avatar,name:e.name})}}},[e._v("\n                檢舉玩家\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,videoUrl:e.videoUrl,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:1})}}},[s("q-item-section",[e._v("\n                刪除\n              ")])],1)],1)],1):e._e(),"admin"===e.userRole?s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:-1})}}},[s("q-item-section",[e._v("\n                移除留言\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",[e._v("\n                凍結玩家\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,videoUrl:e.videoUrl,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1)],1)],1):e._e()],1),s("div",{staticClass:"text-no-wrap text-grey-6"},[e._v("\n        "+e._s(e.computedTime)+"\n      ")])])]),s("app-dialog-report",{attrs:{uid:e.uid,"report-target":e.reportTarget,name:e.name,avatar:e.avatar},model:{value:e.isOpenReportDialog,callback:function(t){e.isOpenReportDialog=t},expression:"isOpenReportDialog"}})],1)},pe=[],me={props:{uid:{type:String},size:{type:String,default:"14px"},avatar:String,signature:String,point:Number,videoUrl:String,role:{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},"killer-level":{type:Number},"killer-type":{type:String},"user-role":{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},name:{type:String},timestamp:{type:Number},messageId:{type:String}},components:{AppDialogReport:O,AppDialogEditProfile:Q,AppDialogProfile:H},data:function(){return{isOpenReportDialog:!1,isOpenProfileDialog:!1,reportTarget:""}},computed:{computedTime:function(){var e=m["b"].formatDate(this.timestamp,"A hh:mm");return e}},methods:{handleReport:function(e){var t=e.reportTarget;e.avatar,e.name;this.reportTarget=t}}},de=me,ue=(s("8689"),Object(v["a"])(de,ce,pe,!1,null,"5f295f90",null)),ve=ue.exports;ue.options.components=Object.assign({QMenu:S["s"],QList:S["r"],QItem:S["n"],QItemSection:S["p"]},ue.options.components||{}),ue.options.directives=Object.assign({ClosePopup:S["a"]},ue.options.directives||{});var ge=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row justify-end no-wrap",style:{fontSize:e.size}},[s("div",[s("div",{staticClass:"row justify-end items-center q-my-xs"},["killer"===e.$store.state.user.profile.role?s("span",{staticClass:"row items-center"},[e.killerLevel?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/killer-"+e.killerLevel+".png",alt:""}}):e._e(),e.killerType?s("span",{staticClass:"q-mr-xs"},[e._v("\n          "+e._s(e.killerType)+"\n        ")]):e._e()]):e._e(),"admin"===e.$store.state.user.profile.role?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/admin.png",alt:""}}):e._e(),s("span",{staticClass:"text-grey-6"},[e._v(e._s(e.name))])]),s("div",{staticClass:"row no-wrap items-center"},[s("div",{staticClass:"text-no-wrap text-grey-6 q-mr-sm"},[e._v("\n        "+e._s(e.computedTime)+"\n      ")]),s("div",{staticClass:"message q-mr-sm",class:{"is-reply":!!e.reply,"user-role":"user"===e.role,"admin-role":"admin"===e.role,"killer-role":"killer"===e.role}},[e.reply&&e.reply.messageId?s("div",{staticClass:"reply-box row q-pa-md"},[s("img",{staticClass:"avatar q-mr-sm",attrs:{src:e.reply.avatar,alt:""}}),s("div",{staticClass:"col q-mr-sm"},[s("div",{staticClass:"text-bold"},[e._v(e._s(e.reply.name))]),e.reply.text?s("div",{staticClass:"ellipsis-2-lines full-width"},[e._v(e._s(e.reply.text))]):e._e()]),s("div",{staticClass:"img-box"},[e.reply.imgUrl?s("img",{staticClass:"q-mr-xs",attrs:{src:e.reply.imgUrl,alt:""},on:{click:function(t){return e.$emit("handleOpenImgView",{imgURL:e.reply.imgUrl})}}}):e._e()]),e.reply.videoUrl?s("div",{staticClass:"video-box q-mr-xs"},[s("video",{staticClass:"video",attrs:{src:e.reply.videoUrl}}),s("q-icon",{staticClass:"play-icon",attrs:{name:"play_circle_outline"}})],1):e._e()]):e._e(),s("div",{staticClass:"text q-py-sm q-px-md text-pre"},[e._v(e._s(e.text))]),s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",disabled:!e.messageId},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:0})}}},[s("q-item-section",[e._v("\n                收回\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,text:e.text,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[s("q-item-section",{on:{click:function(t){return e.$emit("copy-text",{text:e.text})}}},[e._v("\n                複製\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",disabled:!e.messageId},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:1})}}},[s("q-item-section",[e._v("\n                刪除\n              ")])],1)],1)],1)],1)])])])},fe=[],he={props:{size:{type:String,default:"14px"},avatar:String,text:String,role:{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},"killer-level":{type:Number},"killer-type":{type:String},"user-role":{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},name:{type:String},timestamp:{type:Number},messageId:{type:String},reply:{type:Object}},computed:{computedTime:function(){var e=m["b"].formatDate(this.timestamp,"A hh:mm");return e}}},ye=he,xe=(s("28a6"),Object(v["a"])(ye,ge,fe,!1,null,"67678f8d",null)),be=xe.exports;xe.options.components=Object.assign({QIcon:S["l"],QMenu:S["s"],QList:S["r"],QItem:S["n"],QItemSection:S["p"]},xe.options.components||{}),xe.options.directives=Object.assign({ClosePopup:S["a"]},xe.options.directives||{});var qe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row justify-end no-wrap",style:{fontSize:e.size}},[s("div",[s("div",{staticClass:"row justify-end items-center q-my-xs"},["killer"===e.$store.state.user.profile.role?s("span",{staticClass:"row items-center"},[e.killerLevel?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/killer-"+e.killerLevel+".png",alt:""}}):e._e(),e.killerType?s("span",{staticClass:"q-mr-xs"},[e._v("\n          "+e._s(e.killerType)+"\n        ")]):e._e()]):e._e(),"admin"===e.$store.state.user.profile.role?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/admin.png",alt:""}}):e._e(),s("span",{staticClass:"text-grey-6"},[e._v(e._s(e.name))])]),s("div",{staticClass:"row no-wrap items-center"},[s("div",{staticClass:"text-no-wrap text-grey-6 q-mr-sm"},[e._v("\n        "+e._s(e.computedTime)+"\n      ")]),s("div",{staticClass:"text q-px-md q-py-sm",class:{"user-role":"user"===e.$store.state.user.profile.role,"admin-role":"admin"===e.$store.state.user.profile.role,"killer-role":"killer"===e.$store.state.user.profile.role}},[s("img",{staticClass:"img",attrs:{src:e.imgUrl,alt:""},on:{click:function(t){return e.$emit("handleOpenImgView",{imgURL:e.imgUrl})}}}),s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",disabled:!e.messageId},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:0})}}},[s("q-item-section",[e._v("\n                收回\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,imgUrl:e.imgUrl,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",disabled:!e.messageId},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:1})}}},[s("q-item-section",[e._v("\n                刪除\n              ")])],1)],1)],1)],1)])])])},Ce=[],ke={props:{size:{type:String,default:"14px"},avatar:String,imgUrl:String,role:{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},"killer-level":{type:Number},"killer-type":{type:String},"user-role":{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},name:{type:String},timestamp:{type:Number},messageId:{type:String}},computed:{computedTime:function(){var e=m["b"].formatDate(this.timestamp,"A hh:mm");return e}}},we=ke,_e=(s("64af"),Object(v["a"])(we,qe,Ce,!1,null,"40cf91c8",null)),Se=_e.exports;_e.options.components=Object.assign({QMenu:S["s"],QList:S["r"],QItem:S["n"],QItemSection:S["p"]},_e.options.components||{}),_e.options.directives=Object.assign({ClosePopup:S["a"]},_e.options.directives||{});var Ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row justify-end no-wrap",style:{fontSize:e.size}},[s("div",[s("div",{staticClass:"row justify-end items-center q-my-xs"},["killer"===e.$store.state.user.profile.role?s("span",{staticClass:"row items-center"},[e.killerLevel?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/killer-"+e.killerLevel+".png",alt:""}}):e._e(),e.killerType?s("span",{staticClass:"q-mr-xs"},[e._v("\n          "+e._s(e.killerType)+"\n        ")]):e._e()]):e._e(),"admin"===e.$store.state.user.profile.role?s("img",{staticClass:"icon q-mr-xs",attrs:{src:"/statics/chat/admin.png",alt:""}}):e._e(),s("span",{staticClass:"text-grey-6"},[e._v(e._s(e.name))])]),s("div",{staticClass:"row no-wrap items-center"},[s("div",{staticClass:"text-no-wrap text-grey-6 q-mr-sm"},[e._v("\n        "+e._s(e.computedTime)+"\n      ")]),s("div",{staticClass:"text q-px-md q-py-sm",class:{"user-role":"user"===e.$store.state.user.profile.role,"admin-role":"admin"===e.$store.state.user.profile.role,"killer-role":"killer"===e.$store.state.user.profile.role}},[s("video",{staticClass:"video",attrs:{src:e.videoUrl,controls:""}}),s("q-menu",{attrs:{"touch-position":"","context-menu":""}},[s("q-list",{staticStyle:{"min-width":"100px"}},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",disabled:!e.messageId},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:0})}}},[s("q-item-section",[e._v("\n                收回\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.$emit("reply",{avatar:e.avatar,name:e.name,videoUrl:e.videoUrl,messageId:e.messageId})}}},[s("q-item-section",[e._v("\n                回覆\n              ")])],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",disabled:!e.messageId},on:{click:function(t){return e.$emit("deleteMessage",{chatName:"public",messageId:e.messageId,deleteAction:1})}}},[s("q-item-section",[e._v("\n                刪除\n              ")])],1)],1)],1)],1)])])])},Te=[],Ie={props:{size:{type:String,default:"14px"},avatar:String,videoUrl:String,role:{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},"killer-level":{type:Number},"killer-type":{type:String},"user-role":{type:String,default:"user",validator:function(e){return"user"===e||"admin"===e||"killer"===e}},name:{type:String},timestamp:{type:Number},messageId:{type:String}},computed:{computedTime:function(){var e=m["b"].formatDate(this.timestamp,"A hh:mm");return e}}},$e=Ie,Re=(s("3274"),Object(v["a"])($e,Ne,Te,!1,null,"072b8780",null)),Oe=Re.exports;Re.options.components=Object.assign({QMenu:S["s"],QList:S["r"],QItem:S["n"],QItemSection:S["p"]},Re.options.components||{}),Re.options.directives=Object.assign({ClosePopup:S["a"]},Re.options.directives||{});var De={components:{ChatTime:f,ChatReceivedText:se,ChatReceivedImage:re,ChatReceivedVideo:ve,ChatSentText:be,ChatSentImage:Se,ChatSentVideo:Oe},data:function(){return{imgView:{isShow:!1,imgURL:"",imgSize:100},isAutoScroll:!0,tipName:"",tipText:"",replyMessageId:"",replyIndex:null,replyAvatar:"",replyName:"",replyText:"",replyImgUrl:"",replyVideoUrl:""}},computed:{computedMessages:function(){return this.$store.state.chat.public.messages},computedReply:function(){return this.$store.state.chat.public.reply}},watch:{computedMessages:function(e){var t=e[e.length-1];this.isAutoScroll||!1!==t.isSent||(this.tipName=t.name,t.isVideo?this.tipText="傳送了影片":t.isImg?this.tipText="傳送了圖片":this.tipText=t.text),t.isSent&&this.scrollToLast(),this.isAutoScroll&&this.scrollToLast()}},methods:{scrollToLast:function(){this.$refs.virtualListRef.scrollTo(this.computedMessages.length-1)},copyText:function(e){var t=e.text,s=this.$refs.copyTextarea;s.value=t,s.select(),s.setSelectionRange(0,99999),document.execCommand("copy"),s.blur()},handleScroll:function(e){var t=e.index,s=e.to;t===s&&(this.tipName="",this.tipText=""),t>=s?this.isAutoScroll=!0:(0===t&&this.getonce(),this.isAutoScroll=!1)},handleReply:function(e){var t=e.avatar,s=e.name,a=e.text,i=void 0===a?"":a,n=e.imgUrl,l=void 0===n?"":n,o=e.videoUrl,r=void 0===o?"":o,c=e.messageId,p={messageId:c,name:s,avatar:t,text:i,imgUrl:l,videoUrl:r};this.$store.dispatch("chat/createReply",{chatName:"public",reply:p})},closeReplyBox:function(){this.$store.dispatch("chat/clearReply",{chatName:"public"})},focusReplyMessage:function(){for(var e=this,t=function(t,s){if(e.computedMessages[t].messageId===e.computedReply.messageId)return e.$refs.virtualListRef.scrollTo(t),setTimeout((function(){e.$refs.virtualListRef.$el.scrollTo({top:document.querySelector(".chat-scroll-box .q-virtual-scroll__content").childNodes[t].offsetTop-e.$refs.virtualListRef.$el.clientHeight/2+document.querySelector(".chat-scroll-box .q-virtual-scroll__content").childNodes[t].clientHeight/2}),e.$store.dispatch("chat/setReplyIndex",{chatName:"public",index:t})}),100),"break"},s=0,a=this.computedMessages.length;s<a;s+=1){var i=t(s,a);if("break"===i)break}setTimeout((function(){e.$store.dispatch("chat/setReplyIndex",{chatName:"public",index:null})}),1e3)},handleOpenImgView:function(e){var t=e.imgURL;this.imgView.imgURL=t,this.imgView.isShow=!0},getonce:function(){var e=this,t=this.$database.ref("/chat_public"),s=this.$store.state.chat["public"],a=s.firstMessageTime,i=s.messageSize;t.endAt(a).orderByChild("createTime/_seconds").limitToLast(i).once("value",(function(t){var s=[],i=[];t.forEach((function(e){i.push(e.val()),s.push(e.val().createTime._seconds)})),e.$store.dispatch("chat/setFirstMessageTime",{chatName:"public",firstMessageTime:0===s.length?a:s[0]-1}),e.$store.dispatch("chat/pushMessages",{chatName:"public",messages:i}),e.$refs.virtualListRef.scrollTo(i.length)}))},deleteMessage:function(e){var t=this,s=e.chatName,a=e.messageId,i=e.deleteAction;1===i&&this.$q.dialog({title:"聊運彩",message:"確定要刪除訊息嗎? 他人仍然可以看到這個訊息。",cancel:!0,persistent:!0}).onOk((function(){t.$store.dispatch("chat/deleteMessage",{chatName:s,messageId:a,deleteAction:1})})).onCancel((function(){})).onDismiss((function(){})),0===i&&this.$q.dialog({title:"聊運彩",message:"確定要收回訊息嗎? 這訊息大家都無法查看。",cancel:!0,persistent:!0}).onOk((function(){t.$store.dispatch("chat/deleteMessage",{chatName:s,messageId:a,deleteAction:0})})).onCancel((function(){})).onDismiss((function(){})),-1===i&&this.$q.dialog({title:"聊運彩",message:"確定要移除留言嗎?",cancel:!0,persistent:!0}).onOk((function(){t.$store.dispatch("chat/deleteMessage",{chatName:s,messageId:a,deleteAction:-1})})).onCancel((function(){})).onDismiss((function(){}))}},mounted:function(){var e=this,t=this.$database.ref("/chat_public");t.orderByChild("createTime/_seconds").limitToLast(this.$store.state.chat["public"].messageSize).once("value",(function(s){var a=[],i=[];s.forEach((function(e){i.push(e.val()),a.push(e.val().createTime._seconds)})),e.$store.dispatch("chat/setFirstMessageTime",{chatName:"public",firstMessageTime:a[0]-1}),e.$store.dispatch("chat/pushMessages",{chatName:"public",messages:i}),setTimeout((function(){e.$refs.virtualListRef.scrollTo(e.computedMessages.length)}),0),t.orderByChild("createTime/_seconds").limitToLast(1).on("child_added",(function(t){e.$store.dispatch("chat/checkNewMessage",{chatName:"public",newMessage:t.val()})})),t.orderByChild("createTime/_seconds").on("child_changed",(function(e){console.log("update message"),console.log(e.key,e.val())}))}))},destroyed:function(){clearInterval(this._interval),this.$store.dispatch("chat/clearMessages",{chatName:"public"})}},Le=De,Ae=(s("c3a8"),Object(v["a"])(Le,o,r,!1,null,"5301331f",null)),Ue=Ae.exports;Ae.options.components=Object.assign({QVirtualScroll:S["z"],QBadge:S["b"],QBtn:S["c"],QIcon:S["l"],QDialog:S["h"],QSpace:S["w"]},Ae.options.components||{}),Ae.options.directives=Object.assign({ClosePopup:S["a"]},Ae.options.directives||{});var Me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"send-box row items-center q-py-sm page-padding"},[s("chat-upload-file",{staticClass:"q-mr-sm",attrs:{handleAddUploadFile:e.handleAddUploadFile}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],ref:"textArea",staticClass:"text-area col",attrs:{rows:e.textAreaRows,placeholder:"輸入文字"},domProps:{value:e.message},on:{input:[function(t){t.target.composing||(e.message=t.target.value)},e.handleInputSendBox]}}),s("q-btn",{staticClass:"btn q-ml-sm rotate-315",attrs:{color:"white",dense:"",round:"",flat:"",icon:"send"},on:{click:e.handleSubmit}})],1)])},Pe=[],je=(s("4917"),{data:function(){return{textAreaRows:1,message:""}},components:{ChatUploadFile:T},watch:{textAreaRows:function(){this.$refs.textArea.scrollTop=this.$refs.textArea.scrollHeight}},methods:{handleSubmit:function(){var e=this,t=this.$store.state.user.profile,s=t.name,a=t.role,i=t.killerLevel,n=t.killerType,l=t.avatar,o=t.signature,r=t.point;if(0!==this.message.trim().length){var c={messageId:"",tempHash:Object(q["a"])(),isSent:!0,name:s,role:a,killerLevel:i,killerType:n,avatar:l,signature:o,point:r,text:this.message,timestamp:(new Date).getTime()};this.$store.dispatch("chat/addMessage",{chatName:"public",message:c}).then((function(){e.$store.dispatch("chat/clearReply",{chatName:"public"})})),this.message="",this.changeInputSendBoxRows()}else this.$q.dialog({title:"訊息",message:"請輸入文字!"}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))},changeInputSendBoxRows:function(){var e=this.message.match(/(\r\n)|(\n)/g);e?(e.length<3&&(this.textAreaRows=e.length+1),e.length>=3&&(this.textAreaRows=4,this.$refs.textArea.scrollTop=this.$refs.textArea.scrollHeight)):this.textAreaRows=1},handleInputSendBox:function(e){this.changeInputSendBoxRows()},handleAddUploadFile:function(e){var t=this,s=e.file,a=this.$store.state.user.profile,i=a.name,n=a.role,l=a.killerLevel,o=a.killerType,r=a.avatar,c=a.signature,p=a.point;if(/^image/.test(s.type)){if(s.size>=4e6)return void this.$q.dialog({title:"上傳檔案",message:"上傳圖片 ".concat(s.name," 失敗，大小必須在 4 mb 以下")}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}));var m=new FileReader;m.onload=function(e){var a=t.$firebase.storage().ref(),m=(new Date).getTime()+Object(q["a"])(),d=s.type.split("/")[s.type.split("/").length-1],u=a.child("chat/public/".concat(t.$store.state.user.profile.uid,"/").concat(m,".").concat(d));u.put(s).then((function(a){u.getDownloadURL().then((function(a){var m={messageId:"",tempHash:Object(q["a"])(),isSent:!0,name:i,role:n,killerLevel:l,killerType:o,avatar:r,signature:c,point:p,timestamp:(new Date).getTime(),file:e.target.result,fileType:s.type,fileName:s.name,isImg:!0,imgUrl:a};t.$store.dispatch("chat/addMessage",{chatName:"public",message:m})}))}))},m.readAsDataURL(s)}if(/^video/.test(s.type)){if(s.size>=5e7)return void this.$q.dialog({title:"上傳檔案",message:"上傳影音 ".concat(s.name," 失敗，大小必須在 50 mb 以下")}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}));var d=new FileReader;d.onload=function(e){var a=t.$firebase.storage().ref(),m=(new Date).getTime()+Object(q["a"])(),d=s.type.split("/")[s.type.split("/").length-1],u=a.child("chat/public/".concat(t.$store.state.user.profile.uid,"/").concat(m,".").concat(d));u.put(s).then((function(a){u.getDownloadURL().then((function(a){var m={messageId:"",tempHash:Object(q["a"])(),isSent:!0,name:i,role:n,killerLevel:l,killerType:o,avatar:r,signature:c,point:p,timestamp:(new Date).getTime(),file:e.target.result,fileType:s.type,fileName:s.name,isVideo:!0,videoUrl:a};t.$store.dispatch("chat/addMessage",{chatName:"public",message:m})}))}))},d.readAsDataURL(s)}}}}),Qe=je,ze=(s("32bf"),Object(v["a"])(Qe,Me,Pe,!1,null,"6d7b8087",null)),Be=ze.exports;ze.options.components=Object.assign({QBtn:S["c"]},ze.options.components||{});var Ve={components:{ChatMessageBox:Ue,ChatSendBox:Be}},Fe=Ve,Ee=Object(v["a"])(Fe,n,l,!1,null,"36dcf798",null),He=Ee.exports,We={preFetch:function(e){e.store,e.currentRoute,e.previousRoute,e.redirect,e.ssrContext},name:"PageIndex",components:{HomeChat:He}},Je=We,Ye=Object(v["a"])(Je,a,i,!1,null,null,null);t["default"]=Ye.exports;Ye.options.components=Object.assign({QPage:S["t"]},Ye.options.components||{})},"926f":function(e,t,s){},a63b:function(e,t,s){},aa3b:function(e,t,s){},af2d:function(e,t,s){},bad5:function(e,t,s){},c0a83:function(e,t,s){"use strict";var a=s("e0f2"),i=s.n(a);i.a},c3a8:function(e,t,s){"use strict";var a=s("4d2b"),i=s.n(a);i.a},c950:function(e,t,s){"use strict";var a=s("bad5"),i=s.n(a);i.a},e0f2:function(e,t,s){},e3ec:function(e,t,s){},e6a2:function(e,t,s){},efce:function(e,t,s){}}]);