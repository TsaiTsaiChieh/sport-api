(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["7c4b3be2"],{2442:function(t,e,i){},4332:function(t,e,i){},"662b":function(t,e,i){"use strict";var a=i("4332"),s=i.n(a);s.a},"6cb2":function(t,e,i){"use strict";var a=i("b5a6"),s=i.n(a);s.a},b5a6:function(t,e,i){},e783:function(t,e,i){"use strict";var a=i("2442"),s=i.n(a);s.a},f241:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"hHh Lpr fFf"}},[i("q-header",[i("q-toolbar",{staticClass:"bg-linear-gradient"},[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"person","aria-label":"person"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}),i("q-toolbar-title",{staticClass:"row items-center"},[i("router-link",{staticClass:"row items-center",attrs:{to:"/"}},[i("img",{attrs:{alt:"Quasar logo",src:"/statics/logo-chat.png"}})])],1),i("div",[t.$store.state.user.isLoggedIn?i("app-point",{attrs:{point:2500}}):t._e()],1)],1)],1),i("q-drawer",{attrs:{width:250,bordered:"",overlay:"","content-class":"bg-secondary"},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[i("q-list",[t.$store.state.user.isLoggedIn?t._e():i("q-item",{attrs:{clickable:""},on:{click:t.handleLogin}},[i("q-item-section",{staticClass:"nav-item",attrs:{avatar:""}},[i("q-icon",{staticClass:"text-white",attrs:{name:"img:statics/login.png"}})],1),i("q-item-section",[i("q-item-label",{staticClass:"text-white"},[t._v("登入")])],1)],1),t.$store.state.user.isLoggedIn?i("q-item",{attrs:{clickable:""},on:{click:t.handleLogout}},[i("q-item-section",{staticClass:"nav-item",attrs:{avatar:""}},[i("q-icon",{staticClass:"text-white",attrs:{name:"img:statics/logout.png"}})],1),i("q-item-section",[i("q-item-label",{staticClass:"text-white"},[t._v("登出")])],1)],1):t._e(),t.$store.state.user.isLoggedIn?i("q-item",{attrs:{clickable:"",to:"/profile"}},[i("q-item-section",{staticClass:"nav-item",attrs:{avatar:""}},[i("q-icon",{staticClass:"text-white",attrs:{name:"img:statics/profile.png"}})],1),i("q-item-section",[i("q-item-label",{staticClass:"text-white"},[t._v("修改個人資料")])],1)],1):t._e(),t.$store.state.user.isLoggedIn?i("q-item",{attrs:{clickable:""},on:{click:function(e){t.isOpenInviteDialog=!0}}},[i("q-item-section",{staticClass:"nav-item",attrs:{avatar:""}},[i("q-icon",{staticClass:"text-white",attrs:{name:"img:statics/invite.png"}})],1),i("q-item-section",[i("q-item-label",{staticClass:"text-white"},[t._v("邀請朋友")])],1),i("app-dialog-invite",{model:{value:t.isOpenInviteDialog,callback:function(e){t.isOpenInviteDialog=e},expression:"isOpenInviteDialog"}})],1):t._e()],1)],1),i("q-page-container",[i("router-view")],1),i("q-dialog",{ref:"loginDialog"},[i("q-card",{staticStyle:{width:"300px"}},[i("q-card-section",[i("div",{staticClass:"text-h6"},[t._v("登入")])]),i("q-card-section",[i("div",{staticClass:"firebaseui-card-content"},[i("button",{staticClass:"firebaseui-idp-button mdl-button mdl-js-button mdl-button--raised firebaseui-idp-phone firebaseui-id-idp-button",staticStyle:{"background-color":"#02bd7e"}},[i("span",{staticClass:"firebaseui-idp-icon-wrapper"},[i("img",{staticClass:"firebaseui-idp-icon",attrs:{alt:"",src:"/statics/line-icon.png"}})]),i("span",{staticClass:"firebaseui-idp-text firebaseui-idp-text-long"},[t._v("\n              Sign in with Line\n            ")]),i("span",{staticClass:"firebaseui-idp-text firebaseui-idp-text-short"},[t._v("Line")])])]),i("div",{attrs:{id:"firebaseui-auth-container"}})])],1)],1)],1)},s=[],n=(i("7f7f"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"point relative-position"},[i("img",{staticClass:"icon",attrs:{alt:"point img",src:"/statics/point.png"}}),i("span",{staticClass:"text bg-white radius-2 text-grey-8 q-pl-lg q-pr-sm"},[t._v("\n    "+t._s(t.point)+"\n    點\n  ")])])}),o=[],r=(i("c5f6"),{props:{point:Number}}),c=r,l=(i("e783"),i("2877")),u=Object(l["a"])(c,n,o,!1,null,"8e80a9e6",null),p=u.exports,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-dialog",{ref:"dialog",on:{hide:function(e){return t.$emit("hide",!1)}}},[i("q-card",{staticClass:"card"},[i("q-card-section",[i("div",{staticClass:"row justify-center items-center"},[i("q-icon",{staticClass:"text-h6 q-mr-sm",attrs:{name:"share"}}),i("div",{staticClass:"text-h6"},[t._v("\n          好友邀請\n        ")])],1),i("div",{staticClass:"text-center"},[t._v("\n        (二擇一)\n      ")]),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"absolute-top-right q-mt-xs q-mr-xs",attrs:{icon:"close",flat:"",round:"",dense:""}})],1),i("q-card-section",{staticClass:"q-my-lg"},[i("div",{staticClass:"relative-position q-mb-md"},[i("input",{staticClass:"input",attrs:{type:"text",readonly:""},domProps:{value:t.link}}),i("q-btn",{staticClass:"btn q-px-sm",on:{click:function(e){return t.copyText({text:t.link})}}},[t._v("\n          複製連結\n        ")])],1),i("div",{staticClass:"info q-px-md row no-wrap"},[i("q-icon",{staticClass:"q-mr-xs",attrs:{size:"20px",name:"error_outline"}}),i("span",[t._v("從此連結登入，會自動填入邀請代碼")])],1)]),i("q-card-section",{staticClass:"q-my-lg"},[i("div",{staticClass:"relative-position q-mb-md"},[i("input",{staticClass:"input text-red-10",attrs:{type:"text",readonly:""},domProps:{value:t.code}}),i("q-btn",{staticClass:"btn q-px-sm",on:{click:function(e){return t.copyText({text:t.code})}}},[t._v("\n          複製代碼\n        ")])],1),i("div",{staticClass:"info q-px-md row no-wrap"},[i("q-icon",{staticClass:"q-mr-xs",attrs:{size:"20px",name:"error_outline"}}),i("span",[t._v("在會員註冊頁面填入邀請代碼")])],1)])],1),i("textarea",{ref:"copyTextarea",staticClass:"copy-textarea"})],1)},h=[],f={model:{prop:"isOpen",event:"hide"},props:{isOpen:Boolean},data:function(){var t=this.$store.state.user.profile.code;return{link:"http://localhost:8080/profile?invite_code=".concat(t),code:t}},watch:{isOpen:function(t){t&&this.$refs.dialog.show()}},methods:{copyText:function(t){var e=t.text,i=this.$refs.copyTextarea;i.value=e,i.select(),i.setSelectionRange(0,99999),document.execCommand("copy"),i.blur()}}},m=f,g=(i("6cb2"),i("fe09")),v=Object(l["a"])(m,d,h,!1,null,"8fd1a9ce",null),b=v.exports;v.options.components=Object.assign({QDialog:g["h"],QCard:g["e"],QCardSection:g["f"],QIcon:g["l"],QBtn:g["c"]},v.options.components||{}),v.options.directives=Object.assign({ClosePopup:g["a"]},v.options.directives||{});var q={name:"MyLayout",components:{AppPoint:p,AppDialogInvite:b},data:function(){return{apiPath:"https://chat-api.doinfo.cc/",leftDrawerOpen:!1,isOpenInviteDialog:!1}},methods:{handleLogin:function(){var t=this,e={signInSuccessUrl:"/",signInOptions:[{provider:this.$firebase.auth.PhoneAuthProvider.PROVIDER_ID,customParameters:{code:"test"},defaultCountry:"TW",recaptchaParameters:{type:"image",size:"invisible",badge:"bottomleft"}},{provider:this.$firebase.auth.EmailAuthProvider.PROVIDER_ID},{provider:this.$firebase.auth.GoogleAuthProvider.PROVIDER_ID},{provider:this.$firebase.auth.FacebookAuthProvider.PROVIDER_ID,scopes:["public_profile","email","user_likes","user_friends"],customParameters:{auth_type:"reauthenticate"}}]};this.$refs.loginDialog.show(),setTimeout((function(){t.$ui.start("#firebaseui-auth-container",e)}))},handleLogout:function(){var t=this;this.$firebase.auth().signOut().then((function(){t.$axiosInstance.get("/auth/logout").then((function(){t.$store.dispatch("user/logout")}))})).catch((function(){}))},verifySessionCookie:function(){var t=this;this.$axiosInstance.get("/auth/verifySessionCookie").then((function(){t.$axiosInstance.post("/user/getUserProfile").then((function(e){var i=e.data.data,a=i.phone,s=i.email,n=i.displayName,o=i.avatar,r=i.name,c=i.birthday,l=i.signature,u=i.point,p=i.referrer,d=i.defaultTitle,h=i.titles,f=i.status;t.$store.dispatch("user/setProfile",{uid:e.data.uid,name:r,email:s,phoneNumber:a,displayName:n,photoURL:o,birthday:c._seconds,signature:l,point:u,referrer:p,defaultTitle:d,titles:h,status:f})}))})).catch((function(){t.login()}))},login:function(){var t=this,e=this.$firebase.auth().currentUser.ma;e&&this.$axiosInstance.post("/auth/login",{token:e}).then((function(e){if(0!==e.data.status){var i=e.data.data,a=i.phone,s=i.email,n=i.displayName,o=i.avatar,r=i.name,c=i.birthday,l=i.signature,u=i.point,p=i.referrer,d=i.defaultTitle,h=i.titles,f=i.status;t.$store.dispatch("user/setProfile",{uid:e.data.uid,name:r,email:s,phoneNumber:a,displayName:n,photoURL:o,birthday:c._seconds,signature:l,point:u,referrer:p,defaultTitle:d,titles:h,status:f}),-1===e.data.status&&t.$router.push({path:"/"})}else t.$router.push({path:"/profile"})})).catch((function(){t.$store.dispatch("user/logout")}))}},mounted:function(){var t=this;this.$firebase.auth().onAuthStateChanged((function(e){e?t.verifySessionCookie():t.$store.dispatch("user/logout")}))}},C=q,x=(i("662b"),Object(l["a"])(C,a,s,!1,null,"38cd937f",null));e["default"]=x.exports;x.options.components=Object.assign({QLayout:g["q"],QHeader:g["k"],QToolbar:g["x"],QBtn:g["c"],QToolbarTitle:g["y"],QDrawer:g["i"],QList:g["r"],QItem:g["n"],QItemSection:g["p"],QIcon:g["l"],QItemLabel:g["o"],QPageContainer:g["u"],QDialog:g["h"],QCard:g["e"],QCardSection:g["f"]},x.options.components||{})}}]);